# 2024-10-29-TIL

안녕하세요.

오늘은 컴퓨터 구조에서 명령어에 대해 알아보도록하겠습니다.

## 명령어

- 명령어는 수행할 동작과 수행할 대상으로 이루어짐

  - 수행할 대상
    - 수행할 동작에 사용될 데이터 자체가 될 수 있고
    - (메모리나 레지스터의 주소와 같이) 동작에 사용될 데이터가 저장될 위치(**오퍼랜드(operand)**)가 될 수도 있음
  - 수행할 동작
    - 명령어가 수행할 동작 => **연산 코드(opcode)**

- 하나의 명령어는 연산 코드와 0개 이상의 오퍼랜드로 구성되어 있으며, 명령어에서 연산 코드가 담기는 영역은 **연산 코드 필드**, 오퍼랜드가 담기는 영역은 **오퍼랜드 필드**라고 합니다.

  - 오퍼랜드 필드
    - 숫자나 문자와 같이 연산 코드에 사용될 데이터가 직접 명시되기보다는 많은 경우 **연산 코드에 사용될 데이터가 저장된 위치**, 즉, 메모리 주소나  레지스터의 이름이 명시된다는 점
    - **주소 필드(address field)**라고 부르기도 함.
    - 만약, 명령어에 사용된 오퍼랜드에 메모리 주소가 명시되었다면 이 명령어를 실행하기 위한 메모리 접근이 더 필요할 수 있음
    - 예를 들어, CPU가 메모리에 접근해 "곱해라 200번지 값에, 100을"이라는 명령어를 가지고 왔다고 가정해보면, CPU가 메모리로부터 인출한 명령어는 곧바로 실행될 수 없음. 이 명령어를 실행하려면 오퍼랜드 필드에 명시된 메모리 주소를 통해 한 번 더 메모리에 접근해야 함.

  - 연산 코드 필드
    - CPU에 따라 연산 코드의 구체적인 생김새가 다름. 
    - 하지만, 대부분의 CPU가 공통적으로 이해하는 대표적인 연산 코드의 유형에는 **데이터 전송, 산술/논리 연산, 제어 흐름의 변경, 입출력 제어**가 있음

<br/>

### 기계어와 어셈블리어

- CPU가 이해할 수 있도록 0과 1로 표현된 정보를 있는 그대로 표현한 언어를 "**기계어(machine code)**"라고 함
- 기계어만 봐서는 어떻게 동작되는지 쉽사리 짐작하기 어렵기 때문에 등장한 언어가 "**어셈블리어(assembly language)**"
  - 0과 1로 표현된 기계어를 읽기 편한 형태로 단순 번역한 언어
  - CPU가 이해할 수 있는 명령어의 종류와 동작을 파악할 수 있음
  - 0101 0101 => push rbp
  - 0101 1101 => pop rbp

- 같은 프로그램일지라도 CPU마다 이해하는 명령어가 다르면 실행이 불가할 수 있다는 점은 기억해야 함.
  - 예를 들어, 인텔 CPU를 사용하는 컴퓨터에서 만들어진 실행 파일을 애플 CPU를 사용하는 컴퓨터에 그대로 옮겨서 실행할 수 없음.

<br/>

### 명령어 사이클

- 메모리 안에는 프로그램이 저장되어 있고, 이 프로그램은 여러 명령어로 구성되어 있음
- CPU는 이 메모리에서 명령어를 인출하고 실행하기를 반복하며 전체 프로그램을 실행해 나감
- **CPU가 명령어를 처리하는 과정에서 프로그램 속 각각의 명령어들은 일정한 주기를 반복하며 실행**되는데, 이 주기를 명령어 사이클(instruction cycle)이라고 함

#### 메모리에서 저장된 명령어 하나를 실행하고 싶을 때 가장 먼저 해야 할 일은 무엇일까?

- 명령어를 메모리에서 CPU로 가지고 와야(인출해야) 함. (= 인출 사이클(fetch cycle))
- CPU로 명령어를 인출했다면 이제는 그 명령어를 실행햐야 함. (= 실행 사이클(execution cycle))

위 2가지 과정은 계속 반복되는 사이클임.

하지만, 모든 명령어가 단순하게 위 2가지 과정만 반복하며 실행되지는 않음

명령어를 인출했더라도 곧바로 실행할 수 없는 경우도 있음

만약, 오퍼랜드 필드에 메모리 주소가 명시된 경우, CPU가 명령어를 인출했더라도 한 번 더 메모리에 접근해야 함.

이렇게 명령어를 실행하기 위해 한 번더 메모리에 접근하는 단계는 **간접 사이클(indirect cycle)**이라고 함

<img width="929" alt="image" src="https://github.com/user-attachments/assets/9006256e-b4fa-4566-9ebe-6939b661adaa">

<br/>

<br/>

오늘 공부한 내용은 여기까지 입니다.

읽어주셔서 감사합니다.