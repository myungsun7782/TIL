# 2024-11-27-TIL

# CPU 스케줄링

- 운영체제는 다양한 프로세스와 스레드에 'CPU 사용을 배분'함으로써 CPU 자원을 관리한다고 설명함.
- 여기서 운영체제의 CPU 배분 방법이 바로 CPU 스케줄링임.
- CPU 스케줄링 알고리즘을 결정하고 수행하는 운영체제의 일부분을 **CPU 스케줄러(CPU Scheduler)**라고 함.
- 프로세스뿐만 아니라 스레드도 CPU 스케줄링의 대상임. 실행의 문맥을 가지고 있는 모든 것을 스케줄링할 수 있기 때문.

## 우선순위

- 모든 프로세스는 CPU의 자원을 필요로 하기 때문에 운영체제는 공정하고 합리적인 방법으로 CPU의 자원을 프로세스에 할당해야 함.
- CPU의 자원을 공정하게 배분하는 방법이란 단순히 돌아가면서 CPU를 프로세스들에 할당하는 것이 아닙니다. CPU의 자원을 할당받을 프로세스의 우선순위가 다르기 때문.
- 운영체제는 프로세스별 우선순위(priority)를 판단하여 PCB에 명시하고, 우선순위가 높은 프로세스에서는 CPU의 자원을 더 빨리, 더 많이 할당함. 사용자가 일부 프로세스의 우선순위를 직접 높일 수도 있음.
- 운영체제마다 프로세스의 우선순위를 직접 확인할 수 있는 방법을 제공하는데, 유닉스, 리눅스, 맥 OS 등의 유닉스 체계의 운영체제에서는 ps 명령어를 통해 다음과 같이 프로세스의 우선순위를 확인할 수 있음

<img width="548" alt="image" src="https://github.com/user-attachments/assets/d52741e5-62d3-4b61-8192-86fdd9da7191">

(그림출처: 이것이 취업을 위한 컴퓨터과학이다.)

- 윈도우에서는 Process Explorer라는 소프트웨어 'Priority' 항목을 통해 확인할 수 있음. 앞서 정리했던 스레드 수(Threads), 문맥 교환의 횟수(Context Switches)도 확인할 수 있음.

<img width="539" alt="image" src="https://github.com/user-attachments/assets/8b49cb1e-ad25-4a27-98a5-44ced41824c1">

(그림출처: 이것이 취업을 위한 컴퓨터과학이다.)

- 그렇다면 운영체제는 어떤 프로세스에 높고 낮은 우선순위를 할당할까? 다양한 기준이 있지만, 가장 대표적인 고려 요소는 CPU 활용률임. 운영체제는 가급적 CPU 활용률을 높게 유지할 수 있도록 우선순위를 할당함. **CPU 활용률(CPU Utilization)**이란 전체 CPU의 가동 시간 중 작업을 처리하는 시간의 비율을 의미함. 운영체제는 높은 CPU 활용률을 유지하기 위해 기본적으로 입출력 작업이 많은 프로세스의 우선순위를 높게 유지함.
- 대부분의 프로세스들은 CPU와 입출력장치를 모두 사용해 실행과 대기 상태를 오가며 실행됨.
- 이때 프로세스가 CPU를 이용하는 작업을 CPU 버스트(CPU burst)라고 하고, 입출력장치를 기다리는 작업을 입출력 버스트(I/O burst)라고 함. 그런데, 프로세스마다 입출력장치를 이용하는 시간과 CPU를 이용하는 시간의 양에는 차이가 있음.
- 비디오 재생이나 디스크 백업 작업을 담당하는 프로세스처럼 입출력 작업이 많은 프로세스도 있고, 복잡한 수학 연산이나 그래픽 처리 작업을 담당하는 프로세스처럼 CPU 작업이 많은 프로세스도 있음. 전자를 **입출력 집중 프로세스(I/O bound process)**라고 하고, 후자를 **CPU 집중 프로세스(CPU bound process)**라고 함.

<img width="533" alt="image" src="https://github.com/user-attachments/assets/ad06d402-53bb-4e04-aa6e-3a0185b1b2ad">

(그림출처: 이것이 취업을 위한 컴퓨터과학이다.)

- 입출력 집중 프로세스는 실행 상태보다 입출력을 위한 대기 상태에 더 많이 머무르지만, CPU 집중 프로세스는 대기 상태보다 실행 상태에 더 많이 머무름.
- 각자 주로 머무르는 상태가 다르기 때문에 모든 프로세스가 동일한 시간의 빈도로 CPU를 사용하는 것은 합리적이지 않음. 
- 입출력 집중 프로세스와 CPU 집중 프로세스가 동시에 CPU 자원을 요구했다면 **입출력 집중 프로세스를 가능한 빨리 실행시켜 끊임없이 입출력장치를 작동시킨 다음, CPU 집중 프로세스에 집중적으로 CPU를 할당하는 것이 더 합리적**임.
- 입출력장치가 입출력 장치를 완료하기 전까지 입출력 집중 프로세스는 어차피 대기 상태가 될 것이므로 얼른 입출력 집중 프로세스를 먼저 처리해 버리면 그 이후에 다른 프로세스를 실행시켜 CPU 활용률을 높일 수 있음.
- 그래서 입출력 집중 프로세스는 일반적으로 CPU 집중프로세스보다 우선순위가 높은 것. 이렇듯 모든 프로세스가 CPU를 차례대로 돌아가며 사용하는 것보다 상황에 맞게 CPU를 배분하는 것이 더 효율적이므로 운영체제는 프로세스마다 우선순위를 부여해 CPU를 할당함.

